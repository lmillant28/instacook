<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Perfil</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <!-- Flickity CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flickity/2.3.0/flickity.min.css" />
    <!-- Tus estilos -->
    <link rel="stylesheet" href="/css/cabecera.css" />
    <link rel="stylesheet" href="/css/footer.css" />
    <link rel="stylesheet" href="/css/perfil.css" />
</head>

<body>

<!-- Cabecera -->
<header th:replace="Cabecera :: cabecera"></header>

<main>
    <div class="migas" aria-label="Breadcrumb" role="navigation">
        <nav style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E&#34;);" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="/">Página Principal</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">Perfil</li>
            </ol>
        </nav>
    </div>
    <div th:if="${mensaje}">
        <p th:text="${mensaje}" class="alert alert-success" role="status" aria-live="polite"></p>
    </div>
    <div id="total" aria-labelledby="perfil-titulo">
        <div class="perfil">
            <div class="perfil-img">
                <img th:src="@{/imagenes/{usu}(usu=${usuario.imagen})}"
                     alt="Foto de perfil de [[${usuario.nombreUsu}]]"
                     width="140" height="140">
            </div>
            <div class="perfil-datos">
                <h2 id="perfil-titulo" th:text="${usuario.nombreUsu}"></h2>
                <div class="acciones" aria-label="Acciones de perfil">
                    <a class="btn2" th:href="@{/perfil/modificarDatos}" aria-label="Modificar datos de perfil">Modificar datos</a>
                    <a class="btn2" th:href="@{/perfil/modificarContra}" aria-label="Cambiar contraseña">Cambiar contraseña</a>
                    <a class="btn2" th:href="@{/perfil/cerrarSesion}" aria-label="Cerrar sesión">Cerrar sesión</a>
                </div>
                <div class="info"><strong>Nombre:</strong> <span th:text="${usuario.nombre}"></span></div>
                <div class="info"><strong>Correo:</strong> <span th:text="${usuario.correo}"></span></div>
                <div class="info" th:text="${cantidad} + ' recetas'"></div>
            </div>
            <a th:href="@{/perfil/listasUsu}" aria-label="Ver listas de favoritos">
                <span class="perfil-corazon">
                    <i class="bi bi-heart-fill" aria-hidden="true"></i>
                </span>
            </a>
        </div>

        <div class="container px-4 px-lg-5 mt-5" aria-label="Tus recetas">
            <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-flex-start">
                <!-- Botón de añadir como una card -->
                <div class="col mb-5">
                    <div class="card h-100 d-flex align-items-center justify-content-center add-card" tabindex="0" aria-label="Añadir nueva receta">
                        <a th:href="@{/perfil/addRecetaU}" aria-label="Añadir nueva receta">
                            <i class="bi bi-plus-lg" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
                <!-- Recetas -->
                <div class="col mb-5" th:each="receta : ${recetas}" id="carta" tabindex="0"
                     th:aria-label="'Receta: ' + ${receta.nombre} + ', media: ' + ${receta.media}">
                    <div class="card h-100">
                        <div class="badge bg-light text-white position-absolute" style="top: 0.5rem; right: 0.5rem">
                            <a th:href="@{/perfil/eliminaReceta/{rec}(rec=${receta.idReceta})}" th:text="x" class="enlace" aria-label="Eliminar receta"></a>
                        </div>
                        <a th:href="@{/receta/{rec}(rec=${receta.idReceta})}" class="ima" th:aria-label="'Ver receta ' + ${receta.nombre}">
                            <img class="card-img-top"
                                 th:src="@{/imagenes/{img}(img=${receta.imagen})}"
                                 th:alt="${receta.nombre + ' (imagen de la receta)'}" />
                        </a>
                        <div class="card-body p-4">
                            <div class="text-center">
                                <img th:src="@{'/imagenes/reseña-' + ${#numbers.formatDecimal(receta.media, 0, 0)} + '.png'}"
                                     alt="Valoración media: [[${receta.media}]] estrellas" class="media">
                                <a th:href="@{/receta/{rec}(rec=${receta.idReceta})}" th:text="${receta.nombre}" th:aria-label="'Ver receta ' + ${receta.nombre}"></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</main>


<!-- Footer -->
<footer th:replace="Footer :: footer"></footer>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>